!function(e){e.fn.btsListFilter=function(t,n){"use strict";function i(e,t){return e.replace(/\{ *([\w_]+) *\}/g,function(e,n){return t[n]||""})}var s,a,l=this,r=e(this),o=e(t),c=r;return n=e.extend({delay:300,minLength:1,initial:!0,casesensitive:!1,eventKey:"keyup",resetOnBlur:!0,sourceData:null,sourceTmpl:'<a class="list-group-item" href="#"><span>{title}</span></a>',sourceNode:function(e){return i(n.sourceTmpl,e)},emptyNode:function(e){return'<a class="list-group-item well" href="#"><span>Данного города нет</span></a>'},cancelNode:function(){return'<span class="btn fa fa-remove form-control-feedback" aria-hidden="true"></span>'},loadingClass:"bts-loading-list",itemClassTmp:"bts-dynamic-item",itemEl:".list-group-item",itemChild:null,itemFilter:function(t,i){i=i&&i.replace(new RegExp("[({[^.$*+?\\]})]","g"),"");var s=e(t).text(),a=n.initial?"^":"";return new RegExp(a+i,n.casesensitive?"":"i").test(s)}},n),l.reset=function(){o.val("").trigger(n.eventKey)},e.isFunction(n.cancelNode)&&(s=e(n.cancelNode.call(l)).hide(),o.after(s),o.parents(".form-group").addClass("has-feedback"),o.prev().is(".control-label")||s.css({top:0}),s.css({"pointer-events":"auto"}),s.on("click",l.reset)),o.on(n.eventKey,function(e,t){var n;return t=t||300,function(){var i=this,s=arguments;clearTimeout(n),n=setTimeout(function(){e.apply(i,Array.prototype.slice.call(s))},t)}}(function(t){var i=e(this).val();n.itemEl&&(c=r.find(n.itemEl)),n.itemChild&&(c=c.find(n.itemChild));var o=c.filter(function(){return n.itemFilter.call(l,this,i)}),u=c.not(o);n.itemChild&&(o=o.parents(n.itemEl),u=u.parents(n.itemEl).hide()),""!==i&&i.length>=n.minLength?(o.show(),u.hide(),s.show(),"function"===e.type(n.sourceData)?(o.hide(),u.hide(),a&&(e.isFunction(a.abort)?a.abort():e.isFunction(a.stop)&&a.stop()),r.addClass(n.loadingClass),a=n.sourceData.call(l,i,function(t){if(a=null,o.hide(),u.hide(),r.find("."+n.itemClassTmp).remove(),t&&0!==t.length)for(var s in t)e(n.sourceNode.call(l,t[s])).addClass(n.itemClassTmp).appendTo(r);else e(n.emptyNode.call(l,i)).addClass(n.itemClassTmp).appendTo(r);r.removeClass(n.loadingClass)})):(r.find("."+n.itemClassTmp).remove(),0===o.length&&e(n.emptyNode.call(l,i)).addClass(n.itemClassTmp).appendTo(r))):(o.show(),u.show(),s.hide(),r.find("."+n.itemClassTmp).remove())},n.delay)),n.resetOnBlur&&o.on("blur",function(e){l.reset()}),r}}(jQuery);
